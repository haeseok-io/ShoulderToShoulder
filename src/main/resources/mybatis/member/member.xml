<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="me.haeseok.sts.dao.MemberDAO">

    <insert id="addMember" parameterType="MemberDTO" useGeneratedKeys="true" keyProperty="no">
        Insert Into member (email, password, nickname, provider, regdate)
        Values (#{email}, #{password}, #{nickname}, #{provider}, now())
    </insert>

    <select id="findMemberNo" parameterType="long" resultType="memberDTO">
        Select * From member Where no=#{no}
    </select>
    <select id="findMemberEmail" parameterType="String" resultType="memberDTO">
        select * From member Where email=#{email} And provider is NULL
    </select>
    <select id="findMemberEmailAsProvider" parameterType="map" resultType="memberDTO">
        select * From member Where email=#{email} And provider=#{provider}
    </select>
    <select id="emailExist" parameterType="String" resultType="boolean">
        Select count(*) From member Where email=#{email}
    </select>
    <select id="nicknameExist" parameterType="String" resultType="boolean">
        Select count(*) From member Where nickname=#{nickname}
    </select>

    <delete id="dropMember" parameterType="long">
        Delete From member Where no=#{no}
    </delete>
</mapper>